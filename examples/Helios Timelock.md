
# Cardano Example Dapp

## **Helios Timelock**

Builds an Helios Smart Contract on the fly. First transaction will lock coins setting main staking key as owner, second one will be able to unlock it only after some time and using main spending key. Burner/Gift wallets not recommended. Timelock not exactly tested.


## Try it online: 

-  Visit [HTML5 Dapp](https://gamechangerfinance.github.io/gamechanger.wallet/examples/Helios%20Timelock.html)
-  Run [Standalone URL dapp connection](https://beta-wallet.gamechanger.finance/api/2/run/1-H4sIAAAAAAAAA61XW2_TSBT-K5ZfClI2dXxNeAuFXdgtUJEgISG0GnvG7Sy-YY9poqr_fb8zYyfOhbRFNGpizznnO_eZM3e2kioT9gv7jchk2VhLmYusTL7ZI5uLJqllpWRZgP6ylRlvLFZYHeciZ7WyLspC1SxRVllY6kZYabYeW3_KulEW1osGJMhbtzLLLMK1klIWjdUIpWRxbeVMFlaj2Dd6-SbWFmus8rYQ9QgsSVlw4AojHQuLxZmwVGm1hYaSpDWDTKpEbTVlDiLMh43capstfCUK3uGPrZdtDfjzv2SqrFuWZUI1VlEqq4a6PAen4ONNFDRFrOAE1CjRKBARGbWuKGQmPHivxfdW1li6syFAPwZ5Cb63CN4XO9ZawXoNvfbX-3sSUlj89PHyiinYTzG-Uap6cX4OzSy7KRv1wnMc55yLvDxnlTznrKpIW1uQCi7IL1EkUjT0fmCUYaPgiotagFNJlg04OVMMfD9Y1tIr447HfCb8IHYnaeCkXITRLAi9MEjSdObz2J_EiTNlbuJOQ9d3PI5nz7fhSywKkcpEsno9UHAt1KKL_VUbZzL5R6yJWyd4j8-UwA5b0tY1jF5kpXrf5vG-yMWWrLlRVz93LnD0HzGC0uYDziprVdu8MvxaDLS0LvO_Fx_e6wgmNyLH6gSWx__RSiYbZPnLnS0L_E4QhPvRnR2vFWXCvoNxz84SBrHxMElj7fe4amM4-IY1N2_E6uz5vf0o2UGEjyCgoKikGmrJviMPXFz0ldGVCOg3upUvSk5cd7WoMpaIeZY9uxGrZblQ9bMzh0Ve5IRBKEI_nOE7cp2InngYBGmYhCkqJHaY5vMjN0LFRL7r-H44wXsQcvCD7jrm00sEQNQ4idfRgg51wJtGETQGkett1jpeB8iuH4M286fQ5IVTrKf4kHXTMBhK49kLJ6HA7yRMsDqJZpHnEobo7RnIAQ14Aaz3Bra4OgZBGMJKD_8T-Doju07ZclxqYE9KFtDKw7Zo60NQtEdudBhJN0IWOOUCfIRHMhxSyBt6dpMRsnqQnwQ-pPRNmYum2icPz244i2CJ75GVWu8UmYWtLvdgu-9iHRWwm98NAn5d7BE9qis0ZVgJgjJkeE3mDX_P3dcY7JhQ3YEuqMZ0DH1P19xQqytgrwd-irPOfOijQineA99dMagLinsSwQN36uxV2BMxj-eZYgXSIbbxHf5SDQxxDnI6kJ2Z7O5jIdsmQ6bvgmDqT3weOH6C59T3_UmABx-Rxf4-6EqK9fZ9mMM-Hx7zmI5U5E59ZB954BF1cLDJ2MwdWHisE4YYruc53sTDj-d7usS8qYdYIUQeohD-fupT7UP-fOCh4rwZEMAANB-oLtCd30_tc-qws-ejs9crlleZoOnjbHRG5wrt7iO7YjXLBYaEhmaJ15_n764uX__7ar789M7-ikMOBDOkOeNJMHZpi5cAkilO45RljTg4HOac16IZzg0xzXf98sguoJCmiWNCI8wKXJ_GerQy50p3HJ06w3bAxs1QzPipZ5Wr4el2Em53stEHoT4GtSuXNMTuubdcbT0jOiaO5Wea51bEWbaqalWjD3bWx-eR3nShMW5sJgz98IAXmoe-2WYcsFmD-dgYUpUYiNZvuR7QaELRtPfGB7PyvWUIgFqf0kLTkZkURrbk24mThlzBP2jPNbEbZflCXhe63u76ce3pc42uOuDspYKWlqu-yLa20Lrgf3S3D7XSxT5UusnrWK06HV_pmqKYzAS_EnUuG2qEpq96qG_jXKp9A_TiURM0Re1ZsWNE71CXqlsmh5MW0-8ju0VG9Kw9mNuorXtLUHqUUrqu1JqdUGxz5Wm2c-vE2Rb0J33pOVXShmO3qJXK-nn2ZH3sz9qde7LYtARijtzugeykBGTTAHDuoOi3nJr6jlVj03DjYQ32NXqkDHfuGL86KCNhUhXoVHNnMoOxGfJpNzKedjvTL2xm_UaWseL68cLE3Y_xuGPoG7c2KimzjKE0WXaB_l2ITCTdbfxyvricv9q22EFxPNBk5gZ9os0M4FMb7dCMR7Tari0HzWYwu-ylssDNenjJ3Nx3xaoqazVvur19XvCPOBpEvr0KE87wyMtZUpc9-efJ0mKd_p_dsB4JdaJo9sFNs_0WBTv1_8AY8Ct6BocfFFC4lqtHQR7bPe5pN3wqxrZaexT6-x9KzJmM3RIAAA)

## Source code:

- dapp connection code: [GCScript DSL](Helios%20Timelock.gcscript)
- frontend (using @gamechanger-finance/gc): [HTML5 dapp](Helios%20Timelock.html)
- frontend (without official library): [Native HTML5 dapp](Helios%20Timelock_nolib.html)

Dapp code was autogenerated by [Playground IDE in GameChanger Wallet ](https://beta-wallet.gamechanger.finance/playground)

## GCScript code (dapp connection):
```json
{
  "title": "Helios Timelock",
  "description": "Builds an Helios Smart Contract on the fly. First transaction will lock coins setting main staking key as owner, second one will be able to unlock it only after some time and using main spending key. Burner/Gift wallets not recommended. Timelock not exactly tested.",
  "type": "script",
  "require": {
    "not": {
      "walletTypeIn": [
        "burner",
        "gift"
      ]
    }
  },
  "returnURLPattern": "http://localhost:3000/demo/api/dapp",
  "run": {
    "dependencies": {
      "type": "script",
      "run": {
        "stakeCredential": {
          "type": "data",
          "value": "ad03a4ae45b21f50fde67956365cff94db41bc08a2c2862403d8a234"
        },
        "beneficiary": {
          "type": "getSpendingPublicKey"
        },
        "owner": {
          "type": "getStakingPublicKey"
        },
        "currentSlotNumber": {
          "type": "getCurrentSlot"
        },
        "coin": {
          "type": "data",
          "value": "5000000"
        },
        "datum": {
          "type": "plutusData",
          "data": {
            "fromJSON": {
              "schema": 1,
              "obj": {
                "list": [
                  {
                    "int": 1234
                  },
                  {
                    "bytes": "{get('cache.dependencies.owner.pubKeyHashHex')}"
                  },
                  {
                    "bytes": "{get('cache.dependencies.beneficiary.pubKeyHashHex')}"
                  }
                ]
              }
            }
          }
        },
        "smartContract": {
          "type": "plutusScript",
          "script": {
            "heliosCode": "{replaceAll(hexToStr('0a7370656e64696e672074696d655f6c6f636b0a0a73747275637420446174756d207b0a202020206c6f636b556e74696c3a20202054696d650a202020206f776e65723a202020202020205075624b657948617368202f2f20746865206f776e65722063616e20616c7761797320756e6c6f636b20746865206173736574730a2020202062656e65666963696172793a205075624b657948617368202f2f2062656e65666963696172792063616e206f6e6c7920756e6c6f636b207468652061737365747320616674657220276c6f636b556e74696c270a7d0a0a66756e63206d61696e28646174756d3a20446174756d2c205f2c206374783a20536372697074436f6e7465787429202d3e20426f6f6c207b0a2020202074783a205478203d206374782e74783b0a202020206e6f773a2054696d65203d2074782e74696d655f72616e67652e73746172743b0a0a2020202074782e69735f7369676e65645f627928646174756d2e6f776e657229207c7c20280a202020202020202074782e69735f7369676e65645f627928646174756d2e62656e6566696369617279292026260a20202020202020206e6f77203e20646174756d2e6c6f636b556e74696c0a20202020290a7d0a20202020202020200a636f6e7374204558414d504c455f444154554d203a446174756d203d20446174756d7b0a2020202054696d653a3a6e6577284578616d706c6554696d65292c0a202020205075624b6579486173683a3a6e657728233031323334353637383961626364663031323334353637383961626364663031323334353637383961626364663031323334353637383961292c0a202020205075624b6579486173683a3a6e657728236664636261393837363534333231306664636261393837363534333231306664636261393837363534333231306664636261393837363534290a7d0a0a'),'ExampleTime','1234')}",
            "parameters": [
              "EXAMPLE_DATUM"
            ],
            "version": "0.15.2",
            "simplify": false
          }
        },
        "smartContractAddress": {
          "type": "buildAddress",
          "name": "smartContractAddress",
          "addr": {
            "spendScriptHashHex": "{get('cache.dependencies.smartContract.scriptHashHex')}",
            "stakePubKeyHashHex": "{get('cache.dependencies.stakeCredential')}"
          }
        }
      }
    },
    "buildLock": {
      "type": "buildTx",
      "name": "LockingTX",
      "tx": {
        "outputs": [
          {
            "address": "{get('cache.dependencies.smartContractAddress')}",
            "datum": {
              "datumHex": "{get('cache.dependencies.datum.dataHex')}"
            },
            "assets": [
              {
                "policyId": "ada",
                "assetName": "ada",
                "quantity": "{get('cache.dependencies.coin')}"
              }
            ],
            "idPattern": "lockedOutput"
          }
        ],
        "requiredSigners": {
          "owner": "{get('cache.dependencies.owner.pubKeyHashHex')}"
        }
      }
    },
    "signLock": {
      "type": "signTxs",
      "namePattern": "signed-lock",
      "txs": [
        "{get('cache.buildLock.txHex')}"
      ],
      "detailedPermissions": false
    },
    "submitLock": {
      "type": "submitTxs",
      "namePattern": "submitted-lock",
      "txs": "{get('cache.signLock')}"
    },
    "wait": {
      "type": "await",
      "until": {
        "beneficiaryTimeLock": {
          "kind": "timer",
          "unit": "seconds",
          "value": 10
        }
      }
    },
    "buildUnlock": {
      "type": "buildTx",
      "name": "UnlockingTX",
      "tx": {
        "ttl": {
          "from": "{get('cache.dependencies.currentSlotNumber')}"
        },
        "inputs": [
          {
            "txHash": "{get('cache.buildLock.txHash')}",
            "index": "{get('cache.buildLock.indexMap.output.lockedOutput')}"
          }
        ],
        "requiredSigners": {
          "beneficiary": "{get('cache.dependencies.beneficiary.pubKeyHashHex')}"
        },
        "witnesses": {
          "plutus": {
            "scripts": [
              {
                "scriptHex": "{get('cache.dependencies.smartContract.scriptHex')}",
                "lang": "{get('cache.dependencies.smartContract.lang')}"
              }
            ]
          }
        },
        "options": {
          "collateralCoinSelection": "LASLAD"
        }
      }
    },
    "signUnlock": {
      "type": "signTxs",
      "namePattern": "signed-unlock",
      "txs": [
        "{get('cache.buildUnlock.txHex')}"
      ],
      "detailedPermissions": false
    },
    "submitUnlock": {
      "type": "submitTxs",
      "namePattern": "submitted-unlock",
      "txs": "{get('cache.signUnlock')}"
    },
    "finally": {
      "type": "script",
      "exportAs": "LockAndRedeem",
      "run": {
        "locks": {
          "type": "macro",
          "run": "{get('cache.dependencies.locks')}"
        },
        "smartContract": {
          "type": "macro",
          "run": "{get('cache.dependencies.smartContract.scriptHex')}"
        },
        "smartContractHash": {
          "type": "macro",
          "run": "{get('cache.dependencies.smartContract.scriptHashHex')}"
        },
        "smartContractAddress": {
          "type": "macro",
          "run": "{get('cache.dependencies.smartContractAddress')}"
        },
        "lockTx": {
          "type": "macro",
          "run": "{get('cache.buildLock.txHash')}"
        },
        "unlockTx": {
          "type": "macro",
          "run": "{get('cache.buildUnlock.txHash')}"
        }
      }
    }
  }
}
```

## Run standalone QR dapp connection: 

You can use [Playground IDE in GameChanger Wallet ](https://beta-wallet.gamechanger.finance/playground) in `QR URL Transport` mode to capture results

[![This GCScript/URL is too large! make it shorter uploading parts to GCFS. Unable to generate QR code](Helios%20Timelock.png)](https://gamechangerfinance.github.io/gamechanger.wallet/examples/Helios%20Timelock.png)

## Resources
- [How to connect?](https://www.npmjs.com/package/@gamechanger-finance/gc)
- [Docs and examples on Github](https://github.com/GameChangerFinance/gamechanger.wallet/)
- [GCScript documentation](https://beta-wallet.gamechanger.finance/doc/api/v2)
- [Playground IDE in GameChanger Wallet ](https://beta-wallet.gamechanger.finance/playground)
- [Tutorials on Youtube](https://www.youtube.com/@gamechanger.finance)
- [Support on Discord](https://discord.gg/vpbfyRaDKG)
- [News on Twitter](https://twitter.com/GameChangerOk)
- [Website](https://gamechanger.finance)

## License
MIT 
    
